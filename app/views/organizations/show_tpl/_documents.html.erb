<div id="list-documents">
  <% if documents.any? %>
    <% documents.each do |document| %>
      <div class="document-user">
        <div class="col-md-8 col-sm-8 col-xs-8">
          <div class="row">
            <div class="col-md-4" id="image_document">
              <a href="<%= document_path(document) %>">
                <% if document.attachment? %>
                  <%= image_tag document.attachment.preview.url, class: "img-responsive" %>
                <% else %>
                  <%= image_tag Settings.image, class: "img-responsive" %>
                <% end %>
              </a>
            </div>
            <div class="col-md-8">
              <% if document.checked? %>
                <h4>
                  <%= link_to document.name, document_path(document) %>
                </h4>
              <% else %>
                <h4><%= document.name %></h4>
              <% end %>
              <p>
                <i class="fa fa-tag">
                  <span>
                    <%= link_to document.category.name,
                      category_path(document.category) if document.category.present? %>
                  </span>
                  <span class="time">
                      <%= document.created_at.strftime(Settings.format_date) %>
                    </span>
                </i>
              </p>
              <p><%= truncate document.description, length: Settings.organization.description_size %></p>
              <p>
                <% load_categories.each do |category| %>
                  <i class="fa fa-tags"></i>
                  <span><%= link_to category.name, category_path(category) %></span>
                <% end %>
              </p>
              <% if organization.has_admin?(current_user) &&
                organization.guide_id != document.id %>
                <%= form_for @organization do |f| %>
                  <%= hidden_field_tag :guide_id, document.id %>
                  <%= f.submit t(".assign_guide"), class: "btn btn-default" %>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
        <div>
          <% if document.user == current_user || organization.has_admin?(current_user) %>
            <div class="col-md-4 col-sm-4 col-xs-4 setting">
              <button class="btn setting-bars-btn" type="button" data-toggle="dropdown">
                <i class="fa fa-bars" aria-hidden="true"></i>
              </button>
              <ul class="dropdown-menu dropdown-menu-right setting-bars">
                <li>
                  <a class="btn-share" id="<%= document.id %>" data-toggle="modal" data-target="#document_detail_<%= document.id %>">
                    <span class="fa fa-share-square-o"><%= t ".share_member" %></span>
                  </a>
                </li>
                <li>
                  <a class="btn-share-team" id="<%= document.id %>" data-toggle="modal" data-target="#share_team_detail_<%= document.id %>">
                    <span class="fa fa-share-square-o"><%= t ".share_team" %></span>
                  </a>
                </li>
                <% unless organization.guide_id == document.id %>
                  <li>
                    <%= link_to document_path(document), method: :delete,
                      class: "", data: {confirm: t(".delete_confirm")} do %>
                      <span class="fa fa-trash-o"><%= t "organizations.show.delete" %></span>
                    <% end %>
                  </li>
                <% end %>
              </ul>
              <div class="share-member modal" id="document_detail_<%= document.id %>">
                <div class="modal-dialog">
                  <!-- Modal content-->
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                      <h4 class="modal-title">Share to member</h4>
                    </div>
                    <%= form_for document do |f| %>
                      <%= hidden_field_tag :document_id, document.id %>
                      <%= f.hidden_field :status_upload, value: :shared %>

                      <%= f.label :select_member %>
                      <%= select_tag "document[shares_attributes]", options_for_select(
                        load_user_will_share_document(document, organization).map { |user|
                          [user.name, user.id] }), multiple: true,
                            size: Settings.size_share, class: "select-share-document" %>
                      <div class="btn-share">
                        <%= f.submit t(".send"), class: "btn btn-default btn-share" %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
              <div class="share-team modal" id="share_team_detail_<%= document.id %>">
                <div class="modal-dialog">
                  <!-- Modal content-->
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                      <h4 class="modal-title">Share to team</h4>
                    </div>
                    <%= form_for document do |f| %>
                      <%= hidden_field_tag :document_id, document.id %>
                      <%= f.hidden_field :status_upload, value: :shared %>

                      <%= f.label :select_team %>
                      <%= select_tag "document[shares_attributes]", options_for_select(
                        load_team_will_share_document(document, organization).map { |team|
                          [team.name, team.id] }), multiple: true,
                            size: Settings.size_share, class: "select-share-team" %>
                      <div class="btn-share">
                        <%= f.submit t(".send"), class: "btn btn-default " %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
